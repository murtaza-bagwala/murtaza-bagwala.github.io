{"expireTime":9007200911358258000,"key":"transformer-remark-markdown-ast-c1c0a30c63a27847994c3dea66907ffb-gatsby-remark-relative-imagesgatsby-remark-katexgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"thematicBreak","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":4,"offset":4},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"title: Rails 7 adds optional transaction arguments to with_lock\ndate: “2022-03-23T18:00:37.121Z”\ntemplate: “post”\ndraft: false\nslug: “8-ways-to-handle-state-management-part-2”\ncategory: “State Normalization”\ntags:","position":{"start":{"line":3,"column":1,"offset":5},"end":{"line":9,"column":6,"offset":218},"indent":[1,1,1,1,1,1]}}],"position":{"start":{"line":3,"column":1,"offset":5},"end":{"line":9,"column":6,"offset":218},"indent":[1,1,1,1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"“rails”","position":{"start":{"line":10,"column":3,"offset":221},"end":{"line":10,"column":10,"offset":228},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":221},"end":{"line":10,"column":10,"offset":228},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":219},"end":{"line":10,"column":10,"offset":228},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"“rails-7”\ndescription: “With Rails 7 we can pass transaction arguments like isolation, joinable, etc directly to with_lock.”","position":{"start":{"line":11,"column":3,"offset":231},"end":{"line":12,"column":115,"offset":355},"indent":[1]}}],"position":{"start":{"line":11,"column":3,"offset":231},"end":{"line":12,"column":115,"offset":355},"indent":[1]}},{"type":"thematicBreak","position":{"start":{"line":13,"column":1,"offset":356},"end":{"line":13,"column":4,"offset":359},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":229},"end":{"line":13,"column":4,"offset":359},"indent":[1,1]}}],"position":{"start":{"line":10,"column":1,"offset":219},"end":{"line":13,"column":4,"offset":359},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In the database, the Foreign Key constraint enforces referential integrity. \nThis ensures the parent record has to be present before creating a child record \nand these constraints are immediately enforced(checked after each statement). \nBut, this behavior can be changed within a transaction by changing a constraints ","position":{"start":{"line":15,"column":1,"offset":361},"end":{"line":18,"column":82,"offset":679},"indent":[1,1,1]}},{"type":"html","value":"<code class=\"language-text\">deferrable</code>","position":{"start":{"line":18,"column":82,"offset":679},"end":{"line":18,"column":94,"offset":691},"indent":[]}},{"type":"text","value":" characteristics, \nwhich means instead of checking the constraints immediately, these checks will be deferred until the transaction is committed\nand PostgreSQL supports this feature in which constraints ","position":{"start":{"line":18,"column":94,"offset":691},"end":{"line":20,"column":59,"offset":894},"indent":[1,1]}},{"type":"link","title":null,"url":"https://www.postgresql.org/docs/9.2/sql-set-constraints.html","children":[{"type":"text","value":"can be deferred","position":{"start":{"line":20,"column":60,"offset":895},"end":{"line":20,"column":75,"offset":910},"indent":[]}}],"position":{"start":{"line":20,"column":59,"offset":894},"end":{"line":20,"column":138,"offset":973},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}}],"position":{"start":{"line":15,"column":1,"offset":361},"end":{"line":20,"column":138,"offset":973},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"So, before Rails 7, we had to write a raw SQL in migrations to use the ","position":{"start":{"line":22,"column":1,"offset":975},"end":{"line":22,"column":72,"offset":1046},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">deferrable</code>","position":{"start":{"line":22,"column":72,"offset":1046},"end":{"line":22,"column":84,"offset":1058},"indent":[]}},{"type":"text","value":" constraints in Postgres.","position":{"start":{"line":22,"column":84,"offset":1058},"end":{"line":22,"column":109,"offset":1083},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":975},"end":{"line":22,"column":109,"offset":1083},"indent":[]}},{"type":"heading","depth":4,"children":[{"type":"link","url":"#before","title":null,"children":[],"data":{"hProperties":{"aria-label":"before permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Before","position":{"start":{"line":25,"column":6,"offset":1091},"end":{"line":25,"column":12,"offset":1097},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1086},"end":{"line":25,"column":12,"offset":1097},"indent":[]},"data":{"id":"before","htmlAttributes":{"id":"before"},"hProperties":{"id":"before","style":"position:relative;"}}},{"type":"html","lang":"ruby","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># /db/migrate/20220322071034_add_foreign_key_to_reviews.rb</span>\n\nadd_foreign_key <span class=\"token symbol\">:reviews</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:products</span></code></pre></div>","position":{"start":{"line":27,"column":1,"offset":1099},"end":{"line":31,"column":4,"offset":1206},"indent":[1,1,1,1]}},{"type":"html","lang":"ruby","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Product</span><span class=\"token punctuation\">.</span>transaction <span class=\"token keyword\">do</span>\n  review <span class=\"token operator\">=</span> <span class=\"token constant\">Review</span><span class=\"token punctuation\">.</span>create<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>product_id<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> comment<span class=\"token punctuation\">:</span> <span class=\"token string\">\"amazing product\"</span><span class=\"token punctuation\">)</span>\n  product <span class=\"token operator\">=</span> <span class=\"token constant\">Product</span><span class=\"token punctuation\">.</span>create<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Hand Sanitizer\"</span><span class=\"token punctuation\">,</span> description<span class=\"token punctuation\">:</span> <span class=\"token string\">\"new sanitizer in town\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre></div>","position":{"start":{"line":33,"column":1,"offset":1208},"end":{"line":38,"column":4,"offset":1415},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"It will result in the below error","position":{"start":{"line":40,"column":1,"offset":1417},"end":{"line":40,"column":34,"offset":1450},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":1417},"end":{"line":40,"column":34,"offset":1450},"indent":[]}},{"type":"html","lang":"ruby","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">TRANSACTION</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span>ms<span class=\"token punctuation\">)</span>  <span class=\"token constant\">ROLLBACK</span>\n<span class=\"token operator\">/</span><span class=\"token constant\">Users</span><span class=\"token regex\">/murtazabagwala/</span><span class=\"token punctuation\">.</span>rvm<span class=\"token operator\">/</span>gems<span class=\"token operator\">/</span>ruby<span class=\"token operator\">-</span><span class=\"token number\">3.0</span><span class=\"token number\">.2</span><span class=\"token operator\">/</span>gems<span class=\"token operator\">/</span>activerecord<span class=\"token operator\">-</span><span class=\"token number\">7.0</span><span class=\"token number\">.2</span><span class=\"token number\">.3</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>active_record<span class=\"token operator\">/</span>connection_adapters<span class=\"token operator\">/</span>postgresql_adapter<span class=\"token punctuation\">.</span>rb<span class=\"token punctuation\">:</span><span class=\"token number\">768</span><span class=\"token symbol\">:in</span> `exec_params'<span class=\"token punctuation\">:</span> <span class=\"token constant\">PG</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">ForeignKeyViolation</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">ERROR</span><span class=\"token punctuation\">:</span>  insert <span class=\"token keyword\">or</span> update on table <span class=\"token string\">\"reviews\"</span> violates foreign key constraint <span class=\"token string\">\"fk_rails_bedd9094d4\"</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">ActiveRecord</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">InvalidForeignKey</span><span class=\"token punctuation\">)</span>\n<span class=\"token constant\">DETAIL</span><span class=\"token punctuation\">:</span>  <span class=\"token constant\">Key</span> <span class=\"token punctuation\">(</span>product_id<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> is <span class=\"token keyword\">not</span> present <span class=\"token keyword\">in</span> table <span class=\"token string\">\"products\"</span><span class=\"token punctuation\">.</span></code></pre></div>","position":{"start":{"line":42,"column":1,"offset":1452},"end":{"line":46,"column":4,"offset":1868},"indent":[1,1,1,1]}},{"type":"heading","depth":4,"children":[{"type":"link","url":"#after","title":null,"children":[],"data":{"hProperties":{"aria-label":"after permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"After","position":{"start":{"line":48,"column":6,"offset":1875},"end":{"line":48,"column":11,"offset":1880},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1870},"end":{"line":48,"column":11,"offset":1880},"indent":[]},"data":{"id":"after","htmlAttributes":{"id":"after"},"hProperties":{"id":"after","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"But, in Rails 7, while passing the ","position":{"start":{"line":50,"column":1,"offset":1882},"end":{"line":50,"column":36,"offset":1917},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">:deferrable</code>","position":{"start":{"line":50,"column":36,"offset":1917},"end":{"line":50,"column":49,"offset":1930},"indent":[]}},{"type":"text","value":" option to the ","position":{"start":{"line":50,"column":49,"offset":1930},"end":{"line":50,"column":64,"offset":1945},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">add_foreign_key</code>","position":{"start":{"line":50,"column":64,"offset":1945},"end":{"line":50,"column":81,"offset":1962},"indent":[]}},{"type":"text","value":" statement in migrations, \nit is possible to defer this check.","position":{"start":{"line":50,"column":81,"offset":1962},"end":{"line":51,"column":36,"offset":2024},"indent":[1]}}],"position":{"start":{"line":50,"column":1,"offset":1882},"end":{"line":51,"column":36,"offset":2024},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"We can specify whether \nor not the foreign key should be deferrable. \nValid values are booleans or ","position":{"start":{"line":53,"column":1,"offset":2026},"end":{"line":55,"column":30,"offset":2125},"indent":[1,1]}},{"type":"html","value":"<code class=\"language-text\">:deferred</code>","position":{"start":{"line":55,"column":30,"offset":2125},"end":{"line":55,"column":41,"offset":2136},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":55,"column":41,"offset":2136},"end":{"line":55,"column":45,"offset":2140},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">:immediate</code>","position":{"start":{"line":55,"column":45,"offset":2140},"end":{"line":55,"column":57,"offset":2152},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":55,"column":57,"offset":2152},"end":{"line":55,"column":58,"offset":2153},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":2026},"end":{"line":55,"column":58,"offset":2153},"indent":[1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">deferrable: false</code>","position":{"start":{"line":57,"column":3,"offset":2157},"end":{"line":57,"column":22,"offset":2176},"indent":[]}},{"type":"text","value":":- Default value, constraint check is always immediate.","position":{"start":{"line":57,"column":22,"offset":2176},"end":{"line":57,"column":77,"offset":2231},"indent":[]}}],"position":{"start":{"line":57,"column":3,"offset":2157},"end":{"line":57,"column":77,"offset":2231},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":2155},"end":{"line":57,"column":77,"offset":2231},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">deferrable: true</code>","position":{"start":{"line":58,"column":3,"offset":2234},"end":{"line":58,"column":21,"offset":2252},"indent":[]}},{"type":"text","value":" :- Doesn’t change the default behavior, \nbut allows ","position":{"start":{"line":58,"column":21,"offset":2252},"end":{"line":59,"column":12,"offset":2305},"indent":[1]}},{"type":"link","title":null,"url":"https://www.postgresql.org/docs/9.2/sql-set-constraints.html","children":[{"type":"text","value":"manually deferring the check within a transaction","position":{"start":{"line":59,"column":13,"offset":2306},"end":{"line":59,"column":62,"offset":2355},"indent":[]}}],"position":{"start":{"line":59,"column":12,"offset":2305},"end":{"line":59,"column":125,"offset":2418},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":".","position":{"start":{"line":59,"column":125,"offset":2418},"end":{"line":59,"column":126,"offset":2419},"indent":[]}}],"position":{"start":{"line":58,"column":3,"offset":2234},"end":{"line":59,"column":126,"offset":2419},"indent":[1]}}],"position":{"start":{"line":58,"column":1,"offset":2232},"end":{"line":59,"column":126,"offset":2419},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">deferrable: :deferred</code>","position":{"start":{"line":60,"column":3,"offset":2422},"end":{"line":60,"column":26,"offset":2445},"indent":[]}},{"type":"text","value":" :- Constraint check will be done once the transaction is committed \nand allows the ","position":{"start":{"line":60,"column":26,"offset":2445},"end":{"line":61,"column":16,"offset":2529},"indent":[1]}},{"type":"link","title":null,"url":"https://www.postgresql.org/docs/9.2/sql-set-constraints.html","children":[{"type":"text","value":"constraint behavior to change within transaction","position":{"start":{"line":61,"column":17,"offset":2530},"end":{"line":61,"column":65,"offset":2578},"indent":[]}}],"position":{"start":{"line":61,"column":16,"offset":2529},"end":{"line":61,"column":128,"offset":2641},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":".","position":{"start":{"line":61,"column":128,"offset":2641},"end":{"line":61,"column":129,"offset":2642},"indent":[]}}],"position":{"start":{"line":60,"column":3,"offset":2422},"end":{"line":61,"column":129,"offset":2642},"indent":[1]}}],"position":{"start":{"line":60,"column":1,"offset":2420},"end":{"line":61,"column":129,"offset":2642},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">deferrable: :immediate</code>","position":{"start":{"line":62,"column":3,"offset":2645},"end":{"line":62,"column":27,"offset":2669},"indent":[]}},{"type":"text","value":" :- Constraint check is immediate \nand allows the ","position":{"start":{"line":62,"column":27,"offset":2669},"end":{"line":63,"column":16,"offset":2719},"indent":[1]}},{"type":"link","title":null,"url":"https://www.postgresql.org/docs/9.2/sql-set-constraints.html","children":[{"type":"text","value":"constraint behavior to change within transaction","position":{"start":{"line":63,"column":17,"offset":2720},"end":{"line":63,"column":65,"offset":2768},"indent":[]}}],"position":{"start":{"line":63,"column":16,"offset":2719},"end":{"line":63,"column":128,"offset":2831},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":".","position":{"start":{"line":63,"column":128,"offset":2831},"end":{"line":63,"column":129,"offset":2832},"indent":[]}}],"position":{"start":{"line":62,"column":3,"offset":2645},"end":{"line":63,"column":129,"offset":2832},"indent":[1]}}],"position":{"start":{"line":62,"column":1,"offset":2643},"end":{"line":63,"column":129,"offset":2832},"indent":[1]}}],"position":{"start":{"line":57,"column":1,"offset":2155},"end":{"line":63,"column":129,"offset":2832},"indent":[1,1,1,1,1,1]}},{"type":"html","lang":"ruby","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># /db/migrate/20220322071050_add_foreign_key_to_reviews.rb</span>\n\nadd_foreign_key <span class=\"token symbol\">:reviews</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:products</span><span class=\"token punctuation\">,</span> deferrable<span class=\"token punctuation\">:</span> <span class=\"token symbol\">:deferred</span></code></pre></div>","position":{"start":{"line":65,"column":1,"offset":2834},"end":{"line":69,"column":4,"offset":2964},"indent":[1,1,1,1]}},{"type":"html","lang":"ruby","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Product</span><span class=\"token punctuation\">.</span>transaction <span class=\"token keyword\">do</span>\n  review <span class=\"token operator\">=</span> <span class=\"token constant\">Review</span><span class=\"token punctuation\">.</span>create<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>product_id<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> comment<span class=\"token punctuation\">:</span> <span class=\"token string\">\"amazing product\"</span><span class=\"token punctuation\">)</span>\n  product <span class=\"token operator\">=</span> <span class=\"token constant\">Product</span><span class=\"token punctuation\">.</span>create<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Hand Sanitizer\"</span><span class=\"token punctuation\">,</span> description<span class=\"token punctuation\">:</span> <span class=\"token string\">\"new sanitizer in town\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre></div>","position":{"start":{"line":71,"column":1,"offset":2966},"end":{"line":76,"column":4,"offset":3173},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Records will be created successfully","position":{"start":{"line":78,"column":1,"offset":3175},"end":{"line":78,"column":37,"offset":3211},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":3175},"end":{"line":78,"column":37,"offset":3211},"indent":[]}},{"type":"html","lang":"ruby","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">TRANSACTION</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span>ms<span class=\"token punctuation\">)</span>  <span class=\"token keyword\">BEGIN</span>\n<span class=\"token constant\">Review</span> <span class=\"token constant\">Create</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1.7</span>ms<span class=\"token punctuation\">)</span>  <span class=\"token constant\">INSERT</span> <span class=\"token constant\">INTO</span> <span class=\"token string\">\"reviews\"</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"comment\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"created_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"updated_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"product_id\"</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">VALUES</span> <span class=\"token punctuation\">(</span>$<span class=\"token number\">1</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">2</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">3</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">RETURNING</span> <span class=\"token string\">\"id\"</span>  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"comment\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"amazing product\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"created_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2022-03-22 07:44:17.296514\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"updated_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2022-03-22 07:44:17.296514\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"product_id\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token constant\">Product</span> <span class=\"token constant\">Create</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1.5</span>ms<span class=\"token punctuation\">)</span>  <span class=\"token constant\">INSERT</span> <span class=\"token constant\">INTO</span> <span class=\"token string\">\"products\"</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"created_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"updated_at\"</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">VALUES</span> <span class=\"token punctuation\">(</span>$<span class=\"token number\">1</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">2</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">3</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">4</span><span class=\"token punctuation\">,</span> $<span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">RETURNING</span> <span class=\"token string\">\"id\"</span>  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hand Sanitizer\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"new sanitizer in town\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"created_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2022-03-22 07:44:17.306941\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"updated_at\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2022-03-22 07:44:17.306941\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token constant\">TRANSACTION</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2.4</span>ms<span class=\"token punctuation\">)</span>  <span class=\"token constant\">COMMIT</span></code></pre></div>","position":{"start":{"line":80,"column":1,"offset":3213},"end":{"line":85,"column":4,"offset":3889},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Check out this ","position":{"start":{"line":88,"column":1,"offset":3892},"end":{"line":88,"column":16,"offset":3907},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/rails/rails/pull/41487","children":[{"type":"text","value":"pull request","position":{"start":{"line":88,"column":17,"offset":3908},"end":{"line":88,"column":29,"offset":3920},"indent":[]}}],"position":{"start":{"line":88,"column":16,"offset":3907},"end":{"line":88,"column":73,"offset":3964},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":" to know about the change.","position":{"start":{"line":88,"column":73,"offset":3964},"end":{"line":88,"column":99,"offset":3990},"indent":[]}}],"position":{"start":{"line":88,"column":1,"offset":3892},"end":{"line":88,"column":99,"offset":3990},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":89,"column":1,"offset":3991}}}}